<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xiaohuashifu.recruit.user.service.dao.AuthOpenIdMapper">

    <resultMap id="authOpenId" type="com.xiaohuashifu.recruit.user.service.do0.AuthOpenIdDO">
        <id property="id" column="id"/>
        <result property="userId" column="user_id"/>
        <result property="appName" column="app_name"/>
        <result property="openId" column="open_id"/>
        <result property="createTime" column="create_time"/>
        <result property="updateTime" column="update_time"/>
    </resultMap>

    <sql id="auth_open_id">
        id, user_id, app_name, open_id, create_time, update_time
    </sql>

    <insert id="insertAuthOpenId" keyProperty="id">
        insert into auth_open_id(user_id, app_name, open_id)
        values(#{userId}, #{appName}, #{openId})
    </insert>

    <select id="getAuthOpenId" resultMap="authOpenId">
        select <include refid="auth_open_id"/>
        from auth_open_id
        where id = #{id}
    </select>
    
    <select id="getOpenIdByAppNameAndUserId" resultType="string">
        select open_id
        from auth_open_id
        where app_name = #{appName}
        and user_id = #{userId}
    </select>

    <select id="getIdByAppNameAndOpenId" resultType="long">
        select id
        from auth_open_id
        where app_name = #{appName}
        and open_id = #{openId}
    </select>

    <select id="countByUserIdAndAppName" resultType="int">
        select count(*)
        from auth_open_id
        where user_id = #{userId}
        and app_name = #{appName}
    </select>

    <select id="countByAppNameAndOpenId" resultType="int">
        select count(*)
        from auth_open_id
        where app_name = #{appName}
        and open_id = #{openId}
    </select>

</mapper>